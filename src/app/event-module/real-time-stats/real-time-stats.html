<ion-header class="ion-no-border header-blur">
  <ion-toolbar color="dark">
    <ion-buttons slot="start">
      <ion-button fill="clear" (click)="back()">
        <ion-icon name="chevron-back-outline" class="back-icon"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-title class="title-wrap">
      <div class="title">Galaxy Disco Club</div>
      <div class="subtitle">
        <span class="time-range">23:45 - 04:00</span>
        <div class="on-air-badge">
          <span class="pulse-dot"></span>
          <span>ON AIR</span>
        </div>
        <span class="live-text">Live</span>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="page-bg">
  <div class="main-content">
    <div class="top-stats-row">
      <div class="stat-pill">
        <p class="stat-label">Partecipanti</p>
        <p class="stat-value">1.2K</p>
      </div>
      <div class="stat-pill">
        <p class="stat-label">Capacità</p>
        <div class="capacity-container">
          <p class="stat-value">85%</p>
          <div class="capacity-bar">
            <div class="capacity-fill" style="width: 85%"></div>
          </div>
        </div>
      </div>
      <div class="stat-pill">
        <p class="stat-label">Mood</p>
        <div class="energy-bars">
          <div class="energy-bar active" style="animation-delay: 0s;"></div>
          <div class="energy-bar active" style="animation-delay: 0.2s;"></div>
          <div class="energy-bar active" style="animation-delay: 0.4s;"></div>
          <div class="energy-bar"></div>
          <div class="energy-bar"></div>
        </div>
      </div>
    </div>

    <!-- Griglia dinamica -->
    <div class="dynamic-stats-grid">
      @for (w of widgets; track w.id) {
        @switch (w.selector) {
          @case ('app-progress-metric-card') {
            <app-progress-metric-card [statId]="w.id"></app-progress-metric-card>
          }
          @case ('app-gauge-metric-card') {
            <app-gauge-metric-card [statId]="w.id"></app-gauge-metric-card>
          }
          @case ('app-sparkline-kpi-card') {
            <app-sparkline-kpi-card [statId]="w.id"></app-sparkline-kpi-card>
          }
          @case ('app-stacked-progress-card') {
            <app-stacked-progress-card [statId]="w.id"></app-stacked-progress-card>
          }
          @case ('app-donut-chart-card') {
            <app-donut-chart-card [statId]="w.id"></app-donut-chart-card>
          }
          @case ('app-ranking-list-card') {
            <app-ranking-list-card [statId]="w.id"></app-ranking-list-card>
          }
          @case ('app-discrete-histogram-card') {
            <app-discrete-histogram-card [statId]="w.id"></app-discrete-histogram-card>
          }
          @case ('app-bar-rating-card') {
            <app-bar-rating-card [statId]="w.id"></app-bar-rating-card>
          }
          @case ('app-circle-rating-card') {
            <app-circle-rating-card [statId]="w.id"></app-circle-rating-card>
          }
          @case ('app-enum-pill-card') {
            <app-enum-pill-card [statId]="w.id"></app-enum-pill-card>
          }
          @case ('app-minimal-timeline-card') {
            <app-minimal-timeline-card [statId]="w.id"></app-minimal-timeline-card>
          }
          <!-- @default {
            <ion-card>
              <ion-card-content>
                <h3>{{ w.label }}</h3>
                <p class="ion-text-wrap">{{ w.description || 'Nessuna descrizione' }}</p>
                <ion-note>Componente non mappato: {{ w.selector }}</ion-note>
              </ion-card-content>
            </ion-card>
          } -->
        }
      }
    </div>

    <div class="warning-alert">
      <ion-icon name="warning" class="warning-icon"></ion-icon>
      <p>Attenzione: Luci stroboscopiche intense previste alle 02:00.</p>
    </div>

    <ion-card class="stats-card">
      <ion-card-content>
        <h3 class="card-title">Mood & Hype</h3>
        <div class="mood-tags">
          <span class="mood-tag pink">#Euforico</span>
          <span class="mood-tag teal">#Sognante</span>
          <span class="mood-tag purple">#Scatenato</span>
        </div>
        <div class="likes-container">
          <div class="likes-info">
            <ion-icon name="heart" class="heart-icon"></ion-icon>
            <span class="likes-count">1.8k Likes</span>
          </div>
          <div class="sparkline-container">
            <svg class="sparkline" viewBox="0 0 100 30" xmlns="http://www.w3.org/2000/svg">
              <polyline fill="none" points="0,25 10,20 20,22 30,15 40,18 50,10 60,12 70,5 80,8 90,15 100,10" stroke-width="2"></polyline>
            </svg>
          </div>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <div class="footer">
    <p>Network: <span class="network-status">Stabile</span> • Ultimo Sync: <span class="sync-time">Ora</span></p>
  </div>
</ion-content>
