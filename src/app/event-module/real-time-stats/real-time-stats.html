<ion-header class="ion-no-border header-blur">
  <ion-toolbar color="dark">
    <ion-buttons slot="start">
      <ion-button fill="clear" (click)="back()">
        <ion-icon name="chevron-back-outline" class="back-icon"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-title class="title-wrap">
      <div class="title">Galaxy Disco Club</div>
      <div class="subtitle">
        <span class="time-range">23:45 - 04:00</span>
        <div class="on-air-badge">
          <span class="pulse-dot"></span>
          <span>ON AIR</span>
        </div>
        <span class="live-text">Live</span>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="page-bg">
  <div class="main-content">
    <!-- Replaced stacked progress card with minimal timeline card -->
    <div class="timeline-section">
      <app-minimal-timeline-card
        [data]="eventTimeline">
      </app-minimal-timeline-card>
    </div>

    <!-- Added live videos section at the beginning -->
    <div class="videos-card">
      <div class="videos-header">
        <h2 class="section-title">Live Videos</h2>
      </div>
      
      <div class="videos-scroll-container">
        <div class="videos-horizontal-list">
          @for (video of videoStreams; track video; let i = $index) {
            <div class="video-item-template">
              <div class="video-container-template">
                <app-live-videos
                  [videoStream]="video"
                  [showControls]="true">
                </app-live-videos>
              </div>

              <div class="video-info-template">
                <p class="video-title-template">{{ video.title }}</p>
                <p class="video-subtitle-template">{{ video.angle || 'DJ Set' }}</p>
                <p class="video-viewers">{{ video.viewers }} viewers</p>
              </div>
            </div>
          }
        </div>
      </div>
    </div>

    <div class="participants-section">
      <app-participants-avatars
        [participants]="participants"
        [totalCount]="totalParticipants"
        variant="scrollable">
      </app-participants-avatars>
    </div>

    <!-- stack di caroselli: qui ce n'Ã¨ uno solo (ProgressMetric) -->
    <div class="carousels-stack">
      @for (g of carousels; track g.key) {
        <app-component-carousel
          [title]="g.title"
          [componentType]="g.componentType"
          [componentKey]="g.key"
          [dataList]="g.dataList"
          [config]="g.carouselConfig">
        </app-component-carousel>
      }
    </div>

    <div class="warning-alert">
      <ion-icon name="warning" class="warning-icon"></ion-icon>
      <p>Attenzione: Luci stroboscopiche intense previste alle 02:00.</p>
    </div>

    <ion-card class="stats-card">
      <ion-card-content>
        <h3 class="card-title">Mood & Hype</h3>
        <div class="mood-tags">
          <span class="mood-tag pink">#Euforico</span>
          <span class="mood-tag teal">#Sognante</span>
          <span class="mood-tag purple">#Scatenato</span>
        </div>
        <div class="likes-container">
          <div class="likes-info">
            <ion-icon name="heart" class="heart-icon"></ion-icon>
            <span class="likes-count">1.8k Likes</span>
          </div>
          <div class="sparkline-container">
            <svg class="sparkline" viewBox="0 0 100 30" xmlns="http://www.w3.org/2000/svg">
              <polyline fill="none" points="0,25 10,20 20,22 30,15 40,18 50,10 60,12 70,5 80,8 90,15 100,10" stroke-width="2"></polyline>
            </svg>
          </div>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
