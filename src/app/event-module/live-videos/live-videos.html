<div class="live-videos" [class.fullscreen]="isFullscreen">
  <div class="main-video-container" (click)="onVideoClick()" (mousemove)="onMouseMove()" (touchstart)="onMouseMove()">
    <div class="video-wrapper">
      <video #videoEl
        class="main-video"
        [src]="videoStream.url"
        [poster]="videoStream.thumbnail"
        [muted]="isMuted"
        playsinline
        preload="metadata">
      </video>

      <!-- usa showVideoControls, non showControls -->
      <div class="custom-video-overlay" [class.visible]="showVideoControls && showControls">
        <div class="central-play-button" (click)="togglePlay(); $event.stopPropagation()">
          <div class="play-button-circle">
            <ion-icon [name]="isPlaying ? 'pause' : 'play'"></ion-icon>
          </div>
        </div>

        <div class="progress-container">
          <div class="progress-bar">
            <div class="progress-fill" [style.width]="'45%'"></div>
          </div>
        </div>
      </div>

      <div class="live-badge" *ngIf="videoStream?.isLive">
        <div class="live-dot"></div><span>LIVE</span>
      </div>

      <div class="viewer-count">
        <ion-icon name="eye-outline"></ion-icon>
        <span>{{ videoStream.viewers | number }}</span>
      </div>
    </div>
  </div>
</div>

<!-- Added video modal overlay -->
<div class="video-modal-overlay" [class.active]="isModalOpen" (click)="closeModal()">
  <div class="video-modal-container" (click)="$event.stopPropagation()">
    <!-- Modal handle -->
    <div class="modal-handle"></div>
    
    <!-- Close button -->
    <button class="modal-close-btn" (click)="closeModal()">
      <ion-icon name="close"></ion-icon>
    </button>

    <!-- Video container -->
    <div class="modal-video-wrapper">
      <video #modalVideoEl
        class="modal-video"
        [src]="videoStream.url"
        [poster]="videoStream.thumbnail"
        [muted]="isMuted"
        playsinline
        preload="metadata">
      </video>
    </div>

    <!-- Video controls -->
    <div class="modal-controls">
      <button class="modal-play-btn" (click)="togglePlay()">
        <ion-icon [name]="isPlaying ? 'pause' : 'play'"></ion-icon>
      </button>
      
      <div class="modal-progress-container">
        <div class="modal-time-display">
          <span>{{ modalCurrentTime }}</span>
          <div class="modal-progress-bar" (click)="onProgressClick($event)">
            <div class="modal-progress-fill" [style.width.%]="modalProgress"></div>
            <div class="modal-progress-thumb" [style.left.%]="modalProgress"></div>
          </div>
          <span>{{ modalDuration }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
